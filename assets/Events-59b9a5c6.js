import{r as n,a as p,c as S,R as k,j as e,L as N,F as y,b as a,U as C,i as w,B as R}from"./index-f106b69c.js";function E(){const[l,m]=n.useState();return n.useEffect(()=>{l||(async()=>{try{console.log("Fetching events");const d=await p.get(`${S}`,{...k()});m(d.data)}catch(d){console.error("Error fetching Events:",d)}})()},[l]),l}const _=({eventId:l})=>{const[m,g]=n.useState(!0),[d,x]=n.useState(!1),[i,f]=n.useState(null),[b,t]=n.useState(""),[s,o]=n.useState();n.useEffect(()=>{s||(async()=>{const u=await p.get(`${w}s/${l}`);u.status===200&&o(u.data)})()},[s]);const c=r=>{f(u=>u===r?null:r)},h=async()=>{const r=new FormData;if(i!==null&&r.append("rating",i.toString()),r.append("feedback",b),r.append("event",l.toString()),(await p.post(`${w}/`,r,{...k()})).status===201){window.alert("Posted successfully");const v=await p.get(`${w}s/${l}`);v.status===200&&(t(""),f(0),o(v.data),x(!1))}else window.alert("Something went wrong. Please try again with a different data")};return s?e(y,{children:m&&a("div",{className:"mt-4 flex flex-col max-w-xl p-4 sm:p-6 md:p-8 lg:p-12 shadow-md rounded-md dark:bg-gray-900 dark:text-gray-100",children:[e("div",{className:"flex justify-end",children:e("button",{onClick:()=>g(!1),className:"text-2xl text-right text-red-400 focus:outline-none",children:"x"})}),a("div",{children:[e("h3",{className:"text-lg font-semibold mb-2 text-gray-900 dark:text-white",children:"Reviews"}),e("div",{className:"max-h-60 overflow-y-auto mb-4",children:s.length>0?e(y,{children:s.map(r=>a("div",{className:"mb-4",children:[a("div",{className:"flex items-center gap-4",children:[e("img",{src:r.user.image||C,alt:"user",className:"h-8 w-8 rounded-full"}),a("div",{children:[e("p",{className:"font-semibold text-gray-800 dark:text-white",children:r.user.name}),a("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:[r.user.staff_role.name,"/",r.user.department]})]})]}),a("div",{className:"flex flex-col  gap-2 mt-2",children:[e("p",{className:"text-yellow-300",children:"★".repeat(r.rating)}),e("p",{className:"text-gray-800 dark:text-white",children:r.feedback})]}),e("div",{className:"line"})]},r.id))}):"No reviews found"})]}),d?a("div",{className:"mt-4 border border-blue-600 flex flex-col items-center w-full",children:[e("p",{className:" m-4 text-xs sm:text-sm md:text-base lg:text-lg text-center text-gray-600 dark:text-gray-300 mb-2 sm:mb-4",children:"Share your thoughts on the posted event."}),e("div",{className:" m-4 flex items-center justify-center my-2 sm:my-4",children:[1,2,3,4,5].map(r=>e("button",{type:"button",className:`w-10 h-10  mx-1 text-3xl ${i&&r<=i?"text-yellow-300":"text-gray-300"} focus:outline-none`,onClick:()=>c(r),children:"★"},r))}),a("div",{className:"m-4 flex flex-col items-center justify-center w-full",children:[e("div",{className:"relative w-full flex items-center justify-center",children:e("textarea",{id:"feedback",onChange:r=>t(r.target.value),placeholder:"Provide your feedback ...",required:!0,className:"p-2 m-2  sm:p-4 rounded-md placeholder-gray-500 resize-none text-xs sm:text-sm md:text-base lg:text-lg text-gray-800 bg-gray-200 mb-2 sm:mb-4 dark:bg-gray-800 dark:text-gray-200 focus:outline-none"})}),a("div",{className:"flex flex-row items-between",children:[e("button",{type:"button",onClick:h,className:"py-1 px-2 m-1  text-xs sm:text-sm text-white bg-blue-600 hover:bg-blue-700",children:"Send"}),e("button",{type:"button",onClick:()=>x(!1),className:"py-1 px-2  m-1 text-xs sm:text-sm text-white bg-red-600 hover:bg-red-700",children:"close"})]})]})]}):e("button",{type:"button",onClick:()=>x(!0),className:"py-1 px-2 rounded  text-xs sm:text-sm text-white bg-blue-600 hover:bg-blue-700",children:"Review this event"})]})}):e(N,{})},j=_;function L(){const l=E(),[m,g]=n.useState("");localStorage.getItem("username");const[d,x]=n.useState({});if(!l)return e(N,{});const i=t=>{const s=new Date(t),o={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0};return s.toLocaleString("en-US",o)},f=l==null?void 0:l.filter(t=>m?["title","description","category","author","start_date","end_date","created_at"].some(s=>t[s]&&typeof t[s]=="string"&&t[s].toLowerCase().includes(m.toLowerCase())):!0),b=({description:t})=>{const[s,o]=n.useState(!1),c=10,h=t.length>c?t.slice(0,c)+"...":t;return a("p",{className:"mt-5 mb-5 text-sm text-gray-800  dark:text-white",children:[s?t:h,t.length>c&&e("span",{className:"flex flex-wrap cursor-pointer text-blue-500 hover:underline max-w-full inline-block overflow-hidden",onClick:()=>o(!s),children:s?" Read less":" Read more"})]})};return a(y,{children:[e(R,{pageName:"Events"}),e("div",{className:"rounded-sm border  border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1",children:a("div",{className:"sm:block",children:[e("form",{action:"",onSubmit:t=>t.preventDefault(),children:a("div",{className:"relative",children:[e("button",{className:"absolute top-1/2 left-0 -translate-y-1/2",children:a("svg",{className:"fill-body hover:fill-primary dark:fill-bodydark dark:hover:fill-primary",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.16666 3.33332C5.945 3.33332 3.33332 5.945 3.33332 9.16666C3.33332 12.3883 5.945 15 9.16666 15C12.3883 15 15 12.3883 15 9.16666C15 5.945 12.3883 3.33332 9.16666 3.33332ZM1.66666 9.16666C1.66666 5.02452 5.02452 1.66666 9.16666 1.66666C13.3088 1.66666 16.6667 5.02452 16.6667 9.16666C16.6667 13.3088 13.3088 16.6667 9.16666 16.6667C5.02452 16.6667 1.66666 13.3088 1.66666 9.16666Z",fill:""}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.2857 13.2857C13.6112 12.9603 14.1388 12.9603 14.4642 13.2857L18.0892 16.9107C18.4147 17.2362 18.4147 17.7638 18.0892 18.0892C17.7638 18.4147 17.2362 18.4147 16.9107 18.0892L13.2857 14.4642C12.9603 14.1388 12.9603 13.6112 13.2857 13.2857Z",fill:""})]})}),e("input",{type:"text",placeholder:"Type to search...",className:"w-full text-black dark:text-white bg-transparent pr-4 pl-9 focus:outline-none",value:m,onChange:t=>g(t.target.value)})]})}),e("div",{className:"flex items-center justify-between mb-6"}),e("div",{className:"mx-auto mt-10 grid text-gray-800 max-w-2xl gap-y-16 border-t border-gray-200 pt-10 sm:mt-16 sm:pt-16 lg:mx-0 lg:max-w-none lg:grid-cols-3 dark:text-white",children:f.map(t=>{var s,o,c,h,r;return a("div",{className:"flex flex-col bg-white p-6 rounded-md shadow-default dark:bg-boxdark",children:[a("div",{className:"flex flex-wrap items-center gap-x-4",children:[e("img",{src:(s=t.author)!=null&&s.image?`${(o=t.author)==null?void 0:o.image}`:C,alt:"profile",className:"h-10 w-10 rounded-full bg-gray-50  dark:text-white"}),a("div",{className:"text-sm leading-6",children:[e("p",{className:"font-semibold text-gray-900 dark:text-white",children:(c=t.author)==null?void 0:c.name}),a("p",{className:"text-gray-600 dark:text-white",children:[(h=t.author)==null?void 0:h.staff_role.name,"/"," ",(r=t.author)==null?void 0:r.department]})]})]}),a("div",{className:"flex items-center gap-x-4 text-xs mt-3",children:[e("time",{dateTime:i(t.created_at),className:"text-gray-600 dark:text-white",children:i(t.created_at)}),e("p",{className:"relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium hover:text-white text-gray-600 hover:bg-gray-900 dark:hover:bg-white dark:hover:text-black dark:text-white",children:t.category})]}),a("div",{className:"group relative mt-3",children:[e("h3",{className:"mt-3 mb-2 text-lg font-semibold leading-6 text-gray-900 dark:text-white",children:t.title}),a("div",{children:[a("p",{children:["started -"," ",a("span",{children:[" ",e("time",{dateTime:i(t.start_date),className:"text-gray-600 dark:text-white",children:i(t.start_date)})]})]}),a("p",{children:["ended -"," ",a("span",{children:[" ",e("time",{dateTime:i(t.end_date),className:"text-gray-600 dark:text-white",children:i(t.end_date)})]})]})]}),e(b,{description:t.description}),e("a",{href:t.document,className:"relative z-10 mt-4 rounded-full text-xs bg-gray-50 px-3 py-1.5 font-medium hover:text-white text-gray-600 hover:bg-gray-900 dark:hover:bg-white dark:hover:text-black dark:text-white",children:"view document"}),e("button",{onClick:()=>x({...d,[t.id]:!d[t.id]}),className:"relative z-10 mt-4 rounded-full text-xs bg-gray-50 px-3 py-1.5 font-medium hover:text-white text-gray-600 hover:bg-gray-900 dark:hover:bg-white dark:hover:text-black dark:text-white",children:"Review"}),d[t.id]&&e(j,{eventId:t.id})]})]},t.id)})})]})})]})}export{L as default};
